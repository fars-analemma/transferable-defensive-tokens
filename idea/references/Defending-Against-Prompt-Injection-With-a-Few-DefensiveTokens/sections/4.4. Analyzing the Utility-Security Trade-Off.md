4.4. Analyzing the Utility-Security Trade-Off
Security should be measured with utility to make sure the model is useful for a defense. Table4 shows that most evaluated defenses except TextGrad and StruQ-Full (on Falcon3) have a slight utility drop in AlpacaFarm and SEP benchmark. For a high-level view we plot the utility-security trade-off in Fig.3. Even when DefensiveToken is implemented it is the defense that loses the least utility compared to all test-time and training-time baselines. We hypothesize that it is because DefensiveToken adds slight changes (only 5 more tokens) to the system. Also DefensiveToken is the closest defense to an ideal defense (0% ASR no utility loss) against optimization-free attacks on two benchmarks. For optimization-based attacks DefensiveToken still emerges as the best test-time defense with an impressive utility-security trade-off. Even better the slight utility loss of DefensiveToken is only confined to developers who need security and has no impact on those aiming for utility in less risky applications.
[TABLE START]<table>
	<tr>
		<td></td>
		<td>Benchmark</td>
		<td colspan="3">AlpacaFarm</td>
		<td colspan="2">SEP</td>
		<td>TaskTracker</td>
		<td>CyberSecEval2</td>
		<td>InjecAgent</td>
	</tr>
	<tr>
		<td></td>
		<td>Defense</td>
		<td>WinRate \uparrow</td>
		<td>ASR \downarrow</td>
		<td>GCG-ASR \downarrow</td>
		<td>WinRate \uparrow</td>
		<td>ASR \downarrow</td>
		<td>ASR \downarrow</td>
		<td>ASR \downarrow</td>
		<td>ASR \downarrow</td>
	</tr>
	<tr>
		<td rowspan="8">Llama3-8B-Instruct</td>
		<td>None</td>
		<td>26.5</td>
		<td>51.4</td>
		<td>94.7</td>
		<td>50.0</td>
		<td>79.1</td>
		<td>16.4</td>
		<td>49.1</td>
		<td>29.6</td>
	</tr>
	<tr>
		<td>TextGrad</td>
		<td>22.9</td>
		<td>0</td>
		<td>31.6</td>
		<td>1.1</td>
		<td>3.5</td>
		<td>0.25</td>
		<td>1.8</td>
		<td>8.8</td>
	</tr>
	<tr>
		<td>Reminder</td>
		<td>24.4</td>
		<td>34.6</td>
		<td>96.6</td>
		<td>48.3</td>
		<td>75.2</td>
		<td>19.8</td>
		<td>43.6</td>
		<td>42.2</td>
	</tr>
	<tr>
		<td>Sandwich</td>
		<td>26.8</td>
		<td>56.7</td>
		<td>100.0</td>
		<td>46.9</td>
		<td>63.4</td>
		<td>5.5</td>
		<td>41.8</td>
		<td>14.8</td>
	</tr>
	<tr>
		<td>DefensiveToken</td>
		<td>27.0</td>
		<td>0.5</td>
		<td>37.5</td>
		<td>51.6</td>
		<td>3.2</td>
		<td>0.27</td>
		<td>3.6</td>
		<td>2.7</td>
	</tr>
	<tr>
		<td>StruQ-LoRA</td>
		<td>28.0</td>
		<td>0</td>
		<td>4.8</td>
		<td>50.4</td>
		<td>1.5</td>
		<td>0.24</td>
		<td>7.3</td>
		<td>0</td>
	</tr>
	<tr>
		<td>StruQ-Full</td>
		<td>27.9</td>
		<td>0</td>
		<td>2.9</td>
		<td>51.2</td>
		<td>0.4</td>
		<td>0.23</td>
		<td>10.9</td>
		<td>0</td>
	</tr>
	<tr>
		<td>SecAlign-LoRA</td>
		<td>27.0</td>
		<td>0</td>
		<td>1.9</td>
		<td>47.5</td>
		<td>3.1</td>
		<td>0.18</td>
		<td>18.2</td>
		<td>0</td>
	</tr>
	<tr>
		<td rowspan="8">Llama3.1-8B-Instruct</td>
		<td>None</td>
		<td>29.1</td>
		<td>69.2</td>
		<td>96.2</td>
		<td>54.7</td>
		<td>71.4</td>
		<td>26.6</td>
		<td>16.4</td>
		<td>33.0</td>
	</tr>
	<tr>
		<td>TextGrad</td>
		<td>20.9</td>
		<td>15.9</td>
		<td>92.8</td>
		<td>36.3</td>
		<td>22.1</td>
		<td>20.3</td>
		<td>23.6</td>
		<td>25.3</td>
	</tr>
	<tr>
		<td>Reminder</td>
		<td>26.2</td>
		<td>29.8</td>
		<td>97.1</td>
		<td>52.5</td>
		<td>50.6</td>
		<td>23.3</td>
		<td>7.3</td>
		<td>34.3</td>
	</tr>
	<tr>
		<td>Sandwich</td>
		<td>29.7</td>
		<td>60.6</td>
		<td>100.0</td>
		<td>51.5</td>
		<td>55.0</td>
		<td>11.1</td>
		<td>25.5</td>
		<td>21.4</td>
	</tr>
	<tr>
		<td>DefensiveToken</td>
		<td>28.5</td>
		<td>0.5</td>
		<td>24.6</td>
		<td>53.8</td>
		<td>2.8</td>
		<td>0.19</td>
		<td>7.3</td>
		<td>0.6</td>
	</tr>
	<tr>
		<td>StruQ-LoRA</td>
		<td>27.6</td>
		<td>0.5</td>
		<td>10.1</td>
		<td>51.6</td>
		<td>1.4</td>
		<td>0.23</td>
		<td>12.7</td>
		<td>3.9</td>
	</tr>
	<tr>
		<td>StruQ-Full</td>
		<td>28.2</td>
		<td>0</td>
		<td>17.3</td>
		<td>52.9</td>
		<td>0.2</td>
		<td>0.18</td>
		<td>10.9</td>
		<td>1.8</td>
	</tr>
	<tr>
		<td>SecAlign-LoRA</td>
		<td>27.5</td>
		<td>0</td>
		<td>1.0</td>
		<td>50.5</td>
		<td>2.7</td>
		<td>0.19</td>
		<td>5.5</td>
		<td>0.1</td>
	</tr>
	<tr>
		<td rowspan="8">Falcon3-7B-Instruct</td>
		<td>None</td>
		<td>30.7</td>
		<td>84.6</td>
		<td>94.2</td>
		<td>50.5</td>
		<td>80.8</td>
		<td>27.7</td>
		<td>50.9</td>
		<td>20.3</td>
	</tr>
	<tr>
		<td>TextGrad</td>
		<td>28.0</td>
		<td>97.1</td>
		<td>70.8</td>
		<td>47.0</td>
		<td>80.6</td>
		<td>28.1</td>
		<td>29.1</td>
		<td>11.5</td>
	</tr>
	<tr>
		<td>Reminder</td>
		<td>29.8</td>
		<td>75.0</td>
		<td>99.0</td>
		<td>51.8</td>
		<td>83.4</td>
		<td>30.5</td>
		<td>47.3</td>
		<td>27.2</td>
	</tr>
	<tr>
		<td>Sandwich</td>
		<td>30.9</td>
		<td>70.7</td>
		<td>99.0</td>
		<td>49.8</td>
		<td>68.4</td>
		<td>8.9</td>
		<td>43.6</td>
		<td>3.3</td>
	</tr>
	<tr>
		<td>DefensiveToken</td>
		<td>29.2</td>
		<td>4.8</td>
		<td>59.4</td>
		<td>48.3</td>
		<td>6.7</td>
		<td>0.27</td>
		<td>12.7</td>
		<td>1.6</td>
	</tr>
	<tr>
		<td>StruQ-LoRA</td>
		<td>29.2</td>
		<td>1.0</td>
		<td>73.1</td>
		<td>45.4</td>
		<td>11.6</td>
		<td>0.27</td>
		<td>21.8</td>
		<td>0.1</td>
	</tr>
	<tr>
		<td>StruQ-Full</td>
		<td>25.3</td>
		<td>0</td>
		<td>48.8</td>
		<td>31.3</td>
		<td>2.0</td>
		<td>0.20</td>
		<td>7.3</td>
		<td>0</td>
	</tr>
	<tr>
		<td>SecAlign-LoRA</td>
		<td>27.4</td>
		<td>0.5</td>
		<td>81.7</td>
		<td>46.1</td>
		<td>35.4</td>
		<td>1.1</td>
		<td>29.1</td>
		<td>2.4</td>
	</tr>
	<tr>
		<td rowspan="8">Qwen2.5-7B-Instruct</td>
		<td>None</td>
		<td>32.7</td>
		<td>93.3</td>
		<td>95.7</td>
		<td>54.1</td>
		<td>87.1</td>
		<td>37.2</td>
		<td>45.5</td>
		<td>23.5</td>
	</tr>
	<tr>
		<td>TextGrad</td>
		<td>13.8</td>
		<td>97.6</td>
		<td>82.6</td>
		<td>36.1</td>
		<td>90.2</td>
		<td>33.7</td>
		<td>34.6</td>
		<td>19.8</td>
	</tr>
	<tr>
		<td>Reminder</td>
		<td>29.0</td>
		<td>94.7</td>
		<td>99.0</td>
		<td>50.7</td>
		<td>85.0</td>
		<td>35.3</td>
		<td>32.7</td>
		<td>29.6</td>
	</tr>
	<tr>
		<td>Sandwich</td>
		<td>32.3</td>
		<td>85.6</td>
		<td>100.0</td>
		<td>53.3</td>
		<td>70.2</td>
		<td>18.5</td>
		<td>47.3</td>
		<td>11.7</td>
	</tr>
	<tr>
		<td>DefensiveToken</td>
		<td>34.2</td>
		<td>1.0</td>
		<td>73.6</td>
		<td>50.5</td>
		<td>4.3</td>
		<td>0.25</td>
		<td>20.0</td>
		<td>15.8</td>
	</tr>
	<tr>
		<td>StruQ-LoRA</td>
		<td>33.5</td>
		<td>1.4</td>
		<td>65.4</td>
		<td>50.8</td>
		<td>3.9</td>
		<td>0.24</td>
		<td>23.6</td>
		<td>2.1</td>
	</tr>
	<tr>
		<td>StruQ-Full</td>
		<td>31.1</td>
		<td>0</td>
		<td>46.2</td>
		<td>50.5</td>
		<td>2.0</td>
		<td>0.20</td>
		<td>3.6</td>
		<td>0.5</td>
	</tr>
	<tr>
		<td>SecAlign-LoRA</td>
		<td>32.8</td>
		<td>1.9</td>
		<td>64.9</td>
		<td>50.5</td>
		<td>14.7</td>
		<td>0.57</td>
		<td>20.0</td>
		<td>5.5</td>
	</tr>
</table>
Table 4. Utility (WinRate \uparrow) and security (ASR \downarrow) of test-time (TextGrad, Reminder, Sandwich, DefensiveToken) and training-time (StruQ, SecAlign using Full/LoRA fine-tuning) defense baselines. Numbers are averaged across models in  Fig. 2 for visualization.[TABLE END]

[IMAGE START] [IMAGE URL: /mnt/bmcpfs-29000zjpjtl6xjmjiifyk/xkhu/ideation_workspace/papers/reference_figures/cbfd0b621d4454ce2ed6d2196eb2b4d1.png]  [IMAGE URL: /mnt/bmcpfs-29000zjpjtl6xjmjiifyk/xkhu/ideation_workspace/papers/reference_figures/9c308cc6f6449752e228b6460b8eea52.png]  [IMAGE URL: /mnt/bmcpfs-29000zjpjtl6xjmjiifyk/xkhu/ideation_workspace/papers/reference_figures/30278294f860e499cdf2c2620991a405.png]  [IMAGE URL: /mnt/bmcpfs-29000zjpjtl6xjmjiifyk/xkhu/ideation_workspace/papers/reference_figures/c50561b5aba1e79a65dc89a9f5bd9032.png]  [IMAGE URL: /mnt/bmcpfs-29000zjpjtl6xjmjiifyk/xkhu/ideation_workspace/papers/reference_figures/f88c802ed3f020445ca5db4c89ca530d.png]  [IMAGE URL: /mnt/bmcpfs-29000zjpjtl6xjmjiifyk/xkhu/ideation_workspace/papers/reference_figures/8ab012545a6d58d94db7c5c40fef7654.png] Figure 2. The security of DefensiveToken vs. existing test-time and training-time baselines. The values are averaged across all four tested LLMs (Llama3-8B-Instruct, Llama3.1-8B-Instruct, Falcon3-7B-Instruct, and Qwen2.5-7B-Instruct) with breakdown numbers in  Table 4. DefensiveToken is both flexible and effective.[IMAGE END]

[IMAGE START] [IMAGE URL: /mnt/bmcpfs-29000zjpjtl6xjmjiifyk/xkhu/ideation_workspace/papers/reference_figures/ab3f159dcb89a215c736f525035d1e62.png]  [IMAGE URL: /mnt/bmcpfs-29000zjpjtl6xjmjiifyk/xkhu/ideation_workspace/papers/reference_figures/cbd28fa7f93769a3b9baa85a9568e928.png]  [IMAGE URL: /mnt/bmcpfs-29000zjpjtl6xjmjiifyk/xkhu/ideation_workspace/papers/reference_figures/25fc86ced0abfe379f329ae821d2b0db.png] Figure 3. The utility-security trade-off on AlpacaFarm and SEP. The triangles mark test-time defenses, and the squares mark training-time ones. The utility and attack success rate (ASR) are averaged across four tested models. DefensiveToken is flexible with utility-security trade-off close to an ideal defense.[IMAGE END]

[IMAGE START]Table 4. Utility (WinRate \uparrow) and security (ASR \downarrow) of test-time (TextGrad, Reminder, Sandwich, DefensiveToken) and training-time (StruQ, SecAlign using Full/LoRA fine-tuning) defense baselines. Numbers are averaged across models in  Fig. 2[ref_id]S4.F2 for visualization.[IMAGE END]
